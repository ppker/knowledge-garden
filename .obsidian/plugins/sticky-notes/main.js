/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Se=Object.create;var M=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var be=Object.getOwnPropertyNames;var Ee=Object.getPrototypeOf,Ce=Object.prototype.hasOwnProperty;var E=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),we=(n,e)=>{for(var t in e)M(n,t,{get:e[t],enumerable:!0})},Q=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of be(e))!Ce.call(n,o)&&o!==t&&M(n,o,{get:()=>e[o],enumerable:!(i=ye(e,o))||i.enumerable});return n};var Re=(n,e,t)=>(t=n!=null?Se(Ee(n)):{},Q(e||!n||!n.__esModule?M(t,"default",{value:n,enumerable:!0}):t,n)),ke=n=>Q(M({},"__esModule",{value:!0}),n);var ee=E(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.CallbacksRegistry=void 0;var U=class{constructor(){this.nextId=0,this.callbacks={},this.callbackIds=new WeakMap,this.locationInfo=new WeakMap}add(e){let t=this.callbackIds.get(e);if(t!=null)return t;t=this.nextId+=1,this.callbacks[t]=e,this.callbackIds.set(e,t);let i=/at (.*)/gi,o=new Error().stack;if(!o)return t;let r,s;for(;(s=i.exec(o))!==null;){let a=s[1];if(a.includes("(native)")||a.includes("(<anonymous>)")||a.includes("callbacks-registry.js")||a.includes("remote.js")||a.includes("@electron/remote/dist"))continue;let p=/([^/^)]*)\)?$/gi.exec(a);p&&(r=p[1]);break}return this.locationInfo.set(e,r),t}get(e){return this.callbacks[e]||function(){}}getLocation(e){return this.locationInfo.get(e)}apply(e,...t){return this.get(e).apply(global,...t)}remove(e){let t=this.callbacks[e];t&&(this.callbackIds.delete(t),delete this.callbacks[e])}};L.CallbacksRegistry=U});var ne=E(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.deserialize=h.serialize=h.isSerializableObject=h.isPromise=void 0;var Te=require("electron");function _e(n){return n&&n.then&&n.then instanceof Function&&n.constructor&&n.constructor.reject&&n.constructor.reject instanceof Function&&n.constructor.resolve&&n.constructor.resolve instanceof Function}h.isPromise=_e;var Me=[Boolean,Number,String,Date,Error,RegExp,ArrayBuffer];function H(n){return n===null||ArrayBuffer.isView(n)||Me.some(e=>n instanceof e)}h.isSerializableObject=H;var te=function(n,e){let i=Object.entries(n).map(([o,r])=>[o,e(r)]);return Object.fromEntries(i)};function Ne(n){let e=[],t=n.getScaleFactors();if(t.length===1){let i=t[0],o=n.getSize(i),r=n.toBitmap({scaleFactor:i});e.push({scaleFactor:i,size:o,buffer:r})}else for(let i of t){let o=n.getSize(i),r=n.toDataURL({scaleFactor:i});e.push({scaleFactor:i,size:o,dataURL:r})}return{__ELECTRON_SERIALIZED_NativeImage__:!0,representations:e}}function Be(n){let e=Te.nativeImage.createEmpty();if(n.representations.length===1){let{buffer:t,size:i,scaleFactor:o}=n.representations[0],{width:r,height:s}=i;e.addRepresentation({buffer:t,scaleFactor:o,width:r,height:s})}else for(let t of n.representations){let{dataURL:i,size:o,scaleFactor:r}=t,{width:s,height:a}=o;e.addRepresentation({dataURL:i,scaleFactor:r,width:s,height:a})}return e}function V(n){return n&&n.constructor&&n.constructor.name==="NativeImage"?Ne(n):Array.isArray(n)?n.map(V):H(n)?n:n instanceof Object?te(n,V):n}h.serialize=V;function q(n){return n&&n.__ELECTRON_SERIALIZED_NativeImage__?Be(n):Array.isArray(n)?n.map(q):H(n)?n:n instanceof Object?te(n,q):n}h.deserialize=q});var G=E(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.getElectronBinding=void 0;var Le=n=>process._linkedBinding?process._linkedBinding("electron_common_"+n):process.electronBinding?process.electronBinding(n):null;P.getElectronBinding=Le});var ie=E(S=>{"use strict";var $,Y;Object.defineProperty(S,"__esModule",{value:!0});S.browserModuleNames=S.commonModuleNames=void 0;var Pe=G();S.commonModuleNames=["clipboard","nativeImage","shell"];S.browserModuleNames=["app","autoUpdater","BaseWindow","BrowserView","BrowserWindow","contentTracing","crashReporter","dialog","globalShortcut","ipcMain","inAppPurchase","Menu","MenuItem","nativeTheme","net","netLog","MessageChannelMain","Notification","powerMonitor","powerSaveBlocker","protocol","pushNotifications","safeStorage","screen","session","ShareMenu","systemPreferences","TopLevelWindow","TouchBar","Tray","utilityProcess","View","webContents","WebContentsView","webFrameMain"].concat(S.commonModuleNames);var y=Pe.getElectronBinding("features");(($=y==null?void 0:y.isDesktopCapturerEnabled)===null||$===void 0?void 0:$.call(y))!==!1&&S.browserModuleNames.push("desktopCapturer");((Y=y==null?void 0:y.isViewApiEnabled)===null||Y===void 0?void 0:Y.call(y))!==!1&&S.browserModuleNames.push("ImageView")});var le=E(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.createFunctionWithReturnValue=l.getGlobal=l.getCurrentWebContents=l.getCurrentWindow=l.getBuiltin=void 0;var Ae=ee(),A=ne(),d=require("electron"),Ie=ie(),De=G(),{Promise:We}=global,I=new Ae.CallbacksRegistry,D=new Map,ze=new FinalizationRegistry(n=>{let e=D.get(n);e!==void 0&&e.deref()===void 0&&(D.delete(n),d.ipcRenderer.send("REMOTE_BROWSER_DEREFERENCE",u,n,0))}),K=new WeakMap,re=new WeakSet;function Fe(n){let e=D.get(n);if(e!==void 0){let t=e.deref();if(t!==void 0)return t}}function xe(n,e){let t=new WeakRef(e);return D.set(n,t),ze.register(e,n),e}function je(){let n=De.getElectronBinding("v8_util");if(n)return n.getHiddenValue(global,"contextId");throw new Error("Electron >=v13.0.0-beta.6 required to support sandboxed renderers")}var u=process.contextId||je();process.on("exit",()=>{let n="REMOTE_BROWSER_CONTEXT_RELEASE";d.ipcRenderer.send(n,u)});var se=Symbol("is-remote-proxy");function W(n,e=new Set){let t=i=>{if(e.has(i))return{type:"value",value:null};if(i&&i.constructor&&i.constructor.name==="NativeImage")return{type:"nativeimage",value:A.serialize(i)};if(Array.isArray(i)){e.add(i);let o={type:"array",value:W(i,e)};return e.delete(i),o}else{if(i instanceof Buffer)return{type:"buffer",value:i};if(A.isSerializableObject(i))return{type:"value",value:i};if(typeof i=="object"){if(A.isPromise(i))return{type:"promise",then:t(function(r,s){i.then(r,s)})};if(K.has(i))return{type:"remote-object",id:K.get(i)};let o={type:"object",name:i.constructor?i.constructor.name:"",members:[]};e.add(i);for(let r in i)o.members.push({name:r,value:t(i[r])});return e.delete(i),o}else return typeof i=="function"&&re.has(i)?{type:"function-with-return-value",value:t(i())}:typeof i=="function"?{type:"function",id:I.add(i),location:I.getLocation(i),length:i.length}:{type:"value",value:i}}};return n.map(t)}function X(n,e,t,i){if(Array.isArray(i))for(let o of i){if(Object.prototype.hasOwnProperty.call(e,o.name))continue;let r={enumerable:o.enumerable};if(o.type==="method"){let s=function(...p){let w;this&&this.constructor===s?w="REMOTE_BROWSER_MEMBER_CONSTRUCTOR":w="REMOTE_BROWSER_MEMBER_CALL";let he=d.ipcRenderer.sendSync(w,u,t,o.name,W(p));return g(he)},a=Ue(s,t,o.name);r.get=()=>(a.ref=n,a),r.set=p=>(a=p,p),r.configurable=!0}else o.type==="get"&&(r.get=()=>{let s="REMOTE_BROWSER_MEMBER_GET",a=d.ipcRenderer.sendSync(s,u,t,o.name);return g(a)},o.writable&&(r.set=s=>{let a=W([s]),p="REMOTE_BROWSER_MEMBER_SET",w=d.ipcRenderer.sendSync(p,u,t,o.name,a);return w!=null&&g(w),s}));Object.defineProperty(e,o.name,r)}}function ae(n,e,t,i){if(i===null)return;let o={};X(n,o,t,i.members),ae(n,o,t,i.proto),Object.setPrototypeOf(e,o)}function Ue(n,e,t){let i=!1,o=()=>{if(i)return;i=!0;let r="REMOTE_BROWSER_MEMBER_GET",s=d.ipcRenderer.sendSync(r,u,e,t);X(n,n,s.id,s.members)};return new Proxy(n,{set:(r,s,a)=>(s!=="ref"&&o(),r[s]=a,!0),get:(r,s)=>{if(s===se)return!0;Object.prototype.hasOwnProperty.call(r,s)||o();let a=r[s];return s==="toString"&&typeof a=="function"?a.bind(r):a},ownKeys:r=>(o(),Object.getOwnPropertyNames(r)),getOwnPropertyDescriptor:(r,s)=>{let a=Object.getOwnPropertyDescriptor(r,s);return a||(o(),Object.getOwnPropertyDescriptor(r,s))}})}function g(n){if(!n)return{};if(n.type==="value")return n.value;if(n.type==="array")return n.members.map(e=>g(e));if(n.type==="nativeimage")return A.deserialize(n.value);if(n.type==="buffer")return Buffer.from(n.value.buffer,n.value.byteOffset,n.value.byteLength);if(n.type==="promise")return We.resolve({then:g(n.then)});if(n.type==="error")return oe(n);if(n.type==="exception")throw n.value.type==="error"?oe(n.value):new Error(`Unexpected value type in exception: ${n.value.type}`);{let e;if("id"in n){let t=Fe(n.id);if(t!==void 0)return t}if(n.type==="function"){let t=function(...i){let o;this&&this.constructor===t?o="REMOTE_BROWSER_CONSTRUCTOR":o="REMOTE_BROWSER_FUNCTION_CALL";let r=d.ipcRenderer.sendSync(o,u,n.id,W(i));return g(r)};e=t}else e={};return X(e,e,n.id,n.members),ae(e,e,n.id,n.proto),e.constructor&&e.constructor[se]&&Object.defineProperty(e.constructor,"name",{value:n.name}),K.set(e,n.id),xe(n.id,e),e}}function oe(n){let e=n.value;for(let{name:t,value:i}of n.members)e[t]=g(i);return e}function Ve(n){return typeof n.senderId=="number"}function ce(n,e){d.ipcRenderer.on(n,(t,i,o,...r)=>{if(Ve(t)&&t.senderId!==0&&t.senderId!==void 0){console.error(`Message ${n} sent by unexpected WebContents (${t.senderId})`);return}i===u?e(o,...r):d.ipcRenderer.send("REMOTE_BROWSER_WRONG_CONTEXT_ERROR",u,i,o)})}var qe=process.argv.includes("--enable-api-filtering-logging");function R(){let n={stack:void 0};return qe&&Error.captureStackTrace(n,R),n.stack}ce("REMOTE_RENDERER_CALLBACK",(n,e)=>{I.apply(n,g(e))});ce("REMOTE_RENDERER_RELEASE_CALLBACK",n=>{I.remove(n)});l.require=n=>{let e="REMOTE_BROWSER_REQUIRE",t=d.ipcRenderer.sendSync(e,u,n,R());return g(t)};function He(n){let e="REMOTE_BROWSER_GET_BUILTIN",t=d.ipcRenderer.sendSync(e,u,n,R());return g(t)}l.getBuiltin=He;function Ge(){let n="REMOTE_BROWSER_GET_CURRENT_WINDOW",e=d.ipcRenderer.sendSync(n,u,R());return g(e)}l.getCurrentWindow=Ge;function $e(){let n="REMOTE_BROWSER_GET_CURRENT_WEB_CONTENTS",e=d.ipcRenderer.sendSync(n,u,R());return g(e)}l.getCurrentWebContents=$e;function Ye(n){let e="REMOTE_BROWSER_GET_GLOBAL",t=d.ipcRenderer.sendSync(e,u,n,R());return g(t)}l.getGlobal=Ye;Object.defineProperty(l,"process",{enumerable:!0,get:()=>l.getGlobal("process")});function Ke(n){let e=()=>n;return re.add(e),e}l.createFunctionWithReturnValue=Ke;var Xe=n=>{Object.defineProperty(l,n,{enumerable:!0,get:()=>l.getBuiltin(n)})};Ie.browserModuleNames.forEach(Xe)});var de=E(C=>{"use strict";var Ze=C&&C.__createBinding||(Object.create?function(n,e,t,i){i===void 0&&(i=t),Object.defineProperty(n,i,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,i){i===void 0&&(i=t),n[i]=e[t]}),Qe=C&&C.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ze(e,n,t)};Object.defineProperty(C,"__esModule",{value:!0});if(process.type==="browser")throw new Error('"@electron/remote" cannot be required in the browser process. Instead require("@electron/remote/main").');Qe(le(),C)});var ge=E((Et,ue)=>{ue.exports=de()});var Je={};we(Je,{default:()=>j});module.exports=ke(Je);var v=require("obsidian");var c=class{static enable(){this.isEnabled=!0}static disable(){this.isEnabled=!1}static info(e,...t){this.isEnabled&&console.log(`[sticky-notes-plugin]: ${e}`,...t)}static warn(e,...t){this.isEnabled&&console.warn(`[sticky-notes-plugin]: ${e}`,...t)}static error(e,...t){this.isEnabled&&console.error(`[sticky-notes-plugin]: ${e}`,...t)}};c.isEnabled=!1;var O=(i=>(i.DEFAULT="Default",i.CUSTOM="Custom",i.REMEMBER_LAST="Remember last",i))(O||{});var m="background_color",N=[{property:m,value:"Base",lightColor:"#ffffff",darkColor:"#1e1e1e",isDefault:!1},{property:m,value:"Red",lightColor:"#fadadf",darkColor:"#bf2227",isDefault:!1},{property:m,value:"Orange",lightColor:"#fae7d0",darkColor:"#ce721c",isDefault:!1},{property:m,value:"Yellow",lightColor:"#faf0d0",darkColor:"#a87b03",isDefault:!0},{property:m,value:"Green",lightColor:"#d0f0df",darkColor:"#199a53",isDefault:!1},{property:m,value:"Cyan",lightColor:"#d0f0f0",darkColor:"#1a99ad",isDefault:!1},{property:m,value:"Blue",lightColor:"#d0e3fa",darkColor:"#247ad6",isDefault:!1},{property:m,value:"Purple",lightColor:"#e7dffa",darkColor:"#6442d1",isDefault:!1},{property:m,value:"Pink",lightColor:"#f5dae7",darkColor:"#bb3a7a",isDefault:!1}];var ve=300,Oe=300,J={sizeOption:"Default",dimensions:`${ve}x${Oe}`,resizable:!1,rememberBgColors:!1,bgColors:structuredClone(N)};var B=class{constructor(e){this.plugin=e}get settings(){return this._settings}async initSettings(){await this.loadSettings()}async updateSettings(e){c.info("Updated settings",e),this._settings={...this._settings,...e},await this.saveSettings()}async updateWindowDimensions(e,t){let i=`${e}x${t}`;this.updateSettings({dimensions:i})}getWindowDimensions(){return this._settings.dimensions.split("x").map(Number)}async loadSettings(){this._settings=await Object.assign({},J,await this.plugin.loadData()),this.plugin.globalSettings=this._settings}async saveSettings(){await this.plugin.saveData(this._settings)}};var k=require("obsidian"),fe=Re(ge());var me=require("obsidian");function pe(){return"#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0")}function T(){return document.body.classList.contains("theme-light")}var z=class extends me.Menu{constructor(t,i,o,r){super();this.items=[];this.body=t,this.bgColors=i,this.rememberColors=o,this.updateFrontMatter=r,this.addColorItems()}addColorItems(){for(let t of this.bgColors)this.addItem(i=>this.items.push(i.setTitle(t.value).setIcon("circle").onClick(()=>{this.body.setCssProps({"--note-light-color":t.lightColor,"--note-dark-color":t.darkColor}),this.rememberColors&&this.updateFrontMatter(null,{[t.property]:t.value})})))}onload(){super.onload();let t=this.body.querySelector(".menu-scroll");if(t){t.addClass("color-menu");for(let i=0;i<t.children.length;i++){let o=t.children.item(i);o==null||o.addClass("color-menu-item");let r=o==null?void 0:o.querySelector("svg");if(r){let s=T()?this.bgColors[i].lightColor:this.bgColors[i].darkColor;r.style.color=s,r.style.fill=s}}}}};var _=class{constructor(e,t,i){this.settingService=t,this.markdownService=i,this.leaf=e,this.view=e.view,this.document=this.leaf.getContainer().win.activeDocument,this.id=_.stickyNoteId,_.stickyNoteId++,_.leafsList.add(this)}get title(){return`sticky-note-${this.id}`}async initStickyNote(e=null){c.info(`Init Sticky Note ${this.id} ...`),this.document.title=this.title,this.document.documentElement.setAttribute("note-id",this.title),this.initColorMenu(e),this.initView(),this.initMainWindow(),e&&await this.leaf.openFile(e)}initView(){c.info("Initializing Sticky Note view ..."),this.view=this.leaf.view,this.addNoteContainerClass(),this.removeDefaultActionsMenu(),this.removeHeader(),this.addStickyNoteActions()}initMainWindow(){let t=fe.BrowserWindow.getAllWindows().find(r=>r.title===this.title);if(!t){c.warn(`Sticky note ${this.title} does not have an electron window`);return}this.mainWindow=t;let[i,o]=this.settingService.getWindowDimensions();this.mainWindow.setSize(i,o),this.mainWindow.setResizable(this.settingService.settings.resizable),this.settingService.settings.sizeOption==="Remember last"&&this.mainWindow.on("resize",()=>this.saveDimensions()),this.pinAction(!0)}saveDimensions(){try{if(!this.mainWindow)return;let[e,t]=this.mainWindow.getSize();this.settingService.updateWindowDimensions(e,t)}catch(e){c.warn("Could not get and update size ....");return}}addNoteContainerClass(){let e=this.document.body.querySelector(".app-container");e&&e.addClass("sticky-note")}removeDefaultActionsMenu(){let e=this.view.containerEl.querySelector(".view-actions"),t=this.view.containerEl.querySelector(".view-header-left");e==null||e.empty(),t==null||t.empty()}removeHeader(){let e=this.document.querySelector(".workspace-tab-header-container"),t=this.document.querySelector(".titlebar");e==null||e.remove(),t==null||t.empty()}addStickyNoteActions(){var t;if(!(this.view instanceof k.ItemView))return;let e=this.document.querySelector(".view-header-title-container");e==null||e.setCssProps({"app-region":"drag","-webkit-app-region":"drag"}),this.view.addAction("x","Close",()=>this.leaf.detach()).addClass("sticky-note-button"),this.view.addAction("minus","Minimize",()=>{var i;return(i=this.mainWindow)==null?void 0:i.minimize()}).addClass("sticky-note-button"),this.view.addAction((t=this.mainWindow)!=null&&t.isAlwaysOnTop()?"pin-off":"pin","Pin",()=>this.pinAction()).addClasses(["pin-button","sticky-note-button"]),this.view.addAction("palette","Color",i=>this.colorMenu.showAtMouseEvent(i)).addClass("sticky-note-button")}pinAction(e){if(!this.mainWindow)return;let t=e!==void 0?e:!this.mainWindow.isAlwaysOnTop();this.mainWindow.setAlwaysOnTop(t);let i=this.view.containerEl.querySelector(".pin-button");i&&((0,k.setIcon)(i,t?"pin-off":"pin"),(0,k.setTooltip)(i,t?"UnPin":"Pin"))}initColorMenu(e=null){this.colorMenu=new z(this.document.body,this.settingService.settings.bgColors,this.settingService.settings.rememberBgColors,this.markdownService.updateFrontmatterAsync.bind(this.markdownService)),this.setDefaultColor(e)}async setDefaultColor(e=null){var o;let t=this.settingService.settings.rememberBgColors,i=this.settingService.settings.bgColors.find(r=>r.isDefault);if(t){let r=await this.markdownService.getFrontmatterAsync(e);for(let[s,a]of Object.entries(r))i=(o=this.settingService.settings.bgColors.find(p=>p.property===s&&p.value===a))!=null?o:i}if(!i){c.warn("No default color found ...");return}this.document.body.setCssProps({"--note-light-color":i.lightColor,"--note-dark-color":i.darkColor}),t&&this.markdownService.updateFrontmatterAsync(e,{[i.property]:i.value})}},b=_;b.stickyNoteId=0,b.leafsList=new Set;var f=require("obsidian");var F=class extends f.PluginSettingTab{constructor(t,i,o){super(t,i);this.settingService=o}async display(){if(this.containerEl.empty(),!this.settingService.settings){this.containerEl.createEl("p",{text:"falied-to-load-settings"});return}this.addSizeSettings(),this.addColorSettings()}rerenderSettings(){this.display()}updateAndRerenderSettings(t){this.settingService.updateSettings(t),this.rerenderSettings()}addSizeSettings(){let t=new f.Setting(this.containerEl).setName("Size").setHeading();this.addDimensionSetting(this.containerEl),this.addResizableSetting(this.containerEl)}addDimensionSetting(t){return new f.Setting(t).setName("Default size").setDesc("Select what default size each new sticky note window should take. Make sure its in the correct format e.g (width x height)").addDropdown(i=>i.addOptions(Object.fromEntries(Object.values(O).map(o=>[o,o]))).setValue(this.settingService.settings.sizeOption).onChange(async o=>{o==="Default"?this.settingService.updateWindowDimensions(300,300):o==="Remember last"&&this.settingService.updateSettings({resizable:!0}),this.updateAndRerenderSettings({sizeOption:o})})).addText(i=>(this.dimensionsSettingComponent=i.setPlaceholder("eg.: 300x300").setValue(this.settingService.settings.dimensions).onChange(async o=>{let r="300x300";if(o.trim()==="")r="300x300";else if(o.match(/^\d+x\d+$/))r=o;else return;await this.settingService.updateSettings({dimensions:r})}),this.disabledDimensionSetting(this.settingService.settings.sizeOption!=="Custom"),this.dimensionsSettingComponent))}addResizableSetting(t){return new f.Setting(t).setName("Resizable window").setDesc("Enable or disable window resizing for new sticky notes.").addToggle(i=>(this.resizableSettingComponent=i.setValue(this.settingService.settings.resizable||this.settingService.settings.sizeOption==="Remember last").onChange(async o=>{await this.settingService.updateSettings({resizable:o})}),this.disabledResizableSetting(this.settingService.settings.sizeOption==="Remember last"),this.resizableSettingComponent))}addColorSettings(){let t=new f.Setting(this.containerEl).setName("Color").setHeading();return this.addRememberBackgroundColor(this.containerEl),this.addBackgroundColorSetting(this.containerEl),t}addRememberBackgroundColor(t){return new f.Setting(t).setName("Remember background colors").setDesc("Background colors for sticky notes will be stored in the frontmatter of each note.").addToggle(i=>i.setValue(this.settingService.settings.rememberBgColors).onChange(o=>{this.updateAndRerenderSettings({rememberBgColors:o})}))}addBackgroundColorSetting(t){let i=new f.Setting(t).setName("Background colors").setDesc("Adjust sticky note background colors. The toggle determines the default color.").addExtraButton(s=>s.setIcon("rotate-ccw").onClick(()=>this.updateAndRerenderSettings({bgColors:structuredClone(N)}))).addExtraButton(s=>s.setIcon("plus").onClick(()=>{let a=pe();this.settingService.settings.bgColors.push({lightColor:a,darkColor:a,isDefault:!1,property:m,value:`Color ${this.settingService.settings.bgColors.length+1}`}),this.updateAndRerenderSettings({})})),r=new f.Setting(t).setClass("bg-color-settings").settingEl.createDiv();return this.settingService.settings.bgColors.forEach(s=>this.addSingleColorSetting(r,s)),i}addSingleColorSetting(t,i){let o=new f.Setting(t).setClass("single-color-setting").addColorPicker(s=>s.setValue(T()?i.lightColor:i.darkColor).onChange(a=>{T()?i.lightColor=a:i.darkColor=a,this.settingService.updateSettings({})})),r=this.settingService.settings.rememberBgColors;r&&o.addText(s=>s.setPlaceholder("property key").setValue(i.property).onChange(a=>{i.property=a,this.settingService.updateSettings({})})),o.addText(s=>s.setPlaceholder(r?"property value":"color name").setValue(i.value).onChange(a=>{i.value=a,this.settingService.updateSettings({})})).addToggle(s=>s.setValue(i.isDefault).onChange(()=>{this.settingService.settings.bgColors.forEach(a=>a.isDefault=!1),i.isDefault=!0,this.updateAndRerenderSettings({})}).setDisabled(i.isDefault)).addExtraButton(s=>s.setIcon("trash").onClick(()=>{this.settingService.settings.bgColors.remove(i),this.updateAndRerenderSettings({})}).setDisabled(i.isDefault))}disabledDimensionSetting(t){this.dimensionsSettingComponent&&this.disableSettingComponent(this.dimensionsSettingComponent,this.dimensionsSettingComponent.inputEl,t)}disabledResizableSetting(t){this.resizableSettingComponent&&this.disableSettingComponent(this.resizableSettingComponent,this.resizableSettingComponent.toggleEl,t)}disableSettingComponent(t,i,o){return t.setDisabled(o),o?i.addClass("disabled-setting"):i.removeClass("disabled-setting"),t}};var Z=require("obsidian");var x=class{constructor(e){this.plugin=e}async getFrontmatterAsync(e=null){var t;if(e=e!=null?e:this.plugin.app.workspace.getActiveFile(),!(e instanceof Z.TFile))return c.warn("No file is active to retrieve frontmatter"),{};try{let i=(t=this.plugin.app.metadataCache.getFileCache(e))==null?void 0:t.frontmatter;return i||(await this.plugin.app.fileManager.processFrontMatter(e,o=>{i=o}),i!=null?i:{})}catch(i){return c.warn("Failed to get frontmatter:",i),{}}}async updateFrontmatterAsync(e=null,t){if(e=e!=null?e:this.plugin.app.workspace.getActiveFile(),!(e instanceof Z.TFile))return c.warn("No file is active to update frontmatter"),!1;try{return await this.plugin.app.fileManager.processFrontMatter(e,i=>{for(let[o,r]of Object.entries(t))i[o]=r}),!0}catch(i){return c.warn("Failed to update frontmatter:",i),!1}}};var j=class extends v.Plugin{async onload(){c.disable(),c.info("Sticky Notes : plugin loading...."),this.addServices(),this.addSettings(),this.addStickyNoteRibbonAction(),this.addStickyNoteCommand(),this.addStickyNoteMenuOptions(),this.addLeafChangeListner()}onunload(){c.info("Stiky Notes : plugin UN-loading ....")}destroyAllStickyNotes(){b.leafsList.forEach(t=>t.leaf.detach())}addStickyNoteCommand(){this.addCommand({id:"open-sticky-note-view",name:"Open sticky note window",icon:"sticky-note",callback:()=>this.openStickyNotePopup()}),this.addCommand({id:"destroy-sticky-note-views",name:"Destroy all sticky notes",icon:"copy-x",callback:()=>this.destroyAllStickyNotes()})}addStickyNoteRibbonAction(){let t=this.addRibbonIcon("sticky-note","Open sticky note",()=>this.openStickyNotePopup());(0,v.setTooltip)(t,"Sticky note popup")}addStickyNoteMenuOptions(){let t=this.app.workspace.on("file-menu",(o,r)=>r instanceof v.TFile&&this.addStickyNoteMenuItem(o,r)),i=this.app.workspace.on("editor-menu",(o,r,s)=>this.addStickyNoteMenuItem(o,s.file));this.registerEvent(t),this.registerEvent(i)}addStickyNoteMenuItem(t,i){t.addItem(o=>{o.setTitle("Open sticky note").setIcon("sticky-note").onClick(()=>this.openStickyNotePopup(i))})}addServices(){this.markdownService=new x(this)}async addSettings(){this.settingsManager=new B(this),await this.settingsManager.initSettings(),this.addSettingTab(new F(this.app,this,this.settingsManager))}addLeafChangeListner(){let t=this.app.workspace.on("active-leaf-change",i=>{let o=i==null?void 0:i.getContainer().win.activeDocument.documentElement.getAttribute("note-id");b.leafsList.forEach(r=>{r.title===o&&r.initView()})});this.registerEvent(t)}async openStickyNotePopup(t=null){c.info("Opened Sticky Note Popup"),t=t!=null?t:this.app.workspace.getActiveFile();let i=this.app.workspace.openPopoutLeaf({size:{height:300,width:300}});await new b(i,this.settingsManager,this.markdownService).initStickyNote(t)}};

/* nosourcemap */